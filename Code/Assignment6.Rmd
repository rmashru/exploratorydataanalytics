---
title: 'Assignment 5: Social Network Maps'
author: "Rohan Mashru"
date: "March 27, 2019"
output: 
        html_document:
                code_folding: hide
--- 


The dataset is first cleaned up. There are 22 classmates and 42 pairs. Vinay Kumar Aavula was paired with himself thrice - and hence 2 were removed. 
```{r setup, include=TRUE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = TRUE)
knitr::opts_chunk$set(error = TRUE)
knitr::opts_chunk$set(message =  TRUE)

library(igraph)
library(stringr)
d<-read.csv("C:/Users/SNAspring19 - Form Responses 1.csv")
d1<-d[,c(2:7)]
colnames(d1)<-c("Name","Partner_Name","Worked_Times","Partner_Gender","Partner_Profession","Miles")
d2<-d[-c(2,4:5,7),c(2,8:12)]
colnames(d2)<-c("Name","Partner_Name","Worked_Times","Partner_Gender","Partner_Profession","Miles")
d3<-d[-c(2,4,7,10,11,16),c(2,13:17)]
colnames(d3)<-c("Name","Partner_Name","Worked_Times","Partner_Gender","Partner_Profession","Miles")
sna_edges<-unique(rbind(d1,d2,d3))
sna_edges$Name<-word(sna_edges$Name, 1)
sna_edges$Partner_Name<-word(sna_edges$Partner_Name, 1)
sna_nodes<-as.data.frame(as.character(unique(c(word(sna_edges$Name, 1), word(sna_edges$Partner_Name,1)))))
colnames(sna_nodes)<-"Name"
p<-unique(sna_edges[,c(2,4)])
colnames(p)<-c("Name","Gender")
sna_nodes<-merge(sna_nodes, p, by="Name",all.x=TRUE)
```


##Plot 1
The below graph shows the different pairs classmates had. We can see that males highlighted in red tend to work with males. We can see that Vinay worked with himself and no one else. Lan, Tianhe, Tongtian and Jiaoyan work among themselves in a group and no one else in the class. Rohan, Karan, Raghu and Subhash also work amongst themselves. Subhash has also worked with Yash. 

```{r}
net1<-graph_from_data_frame(
        d=sna_edges,
        vertices=sna_nodes,
        directed = FALSE)

male<-subset(sna_nodes, Gender=="Male")
female<-subset(sna_nodes, Gender=="Female")

V(net1)$color <- NA
V(net1)$color[V(net1)$name %in% male$Name] <- "red"
V(net1)$color[V(net1)$name %in% female$Name] <- "gold"
par(mar=c(0,0,0,0))


set.seed(100)
fr <- layout_with_fr(net1, niter=1000)

plot(net1,vertex.label.color = "black", 
     vertex.label.cex = .75, 
     edge.curved=.25, 
     edge.color="grey20", layout=fr)
  
legend(x=1.25, y=1, legend=c("male", "female", "unknown"), 
       pch=21, pt.bg=c("red", "gold", "grey20"), pt.cex=2, bty="n")
```


##Plot 2
This plot shows us that Pavan, Lan, Rohan and Doruk have worked  maximum number of times together. Them Karan, Shirya and Jiaoyan. The size of the nodes depict number of times partners have worked together.

```{r}
V(net1)$size <-E(net1)$Worked_Times * 10
par(mar=c(0,0,0,0)); plot(net1, vertex.color = "grey", 
     vertex.label.color = "black", 
     vertex.label.cex = 1, 
     edge.curved=.25, 
     edge.color="grey20")
```

##Plot 3
Plot 3 segregates the males and females like Plot 1. It shows us whether people work in the same profession. Blanks indicate we do not know the profession. From the professions that we know, we see a bigger tendency of classmates beloning to different professions working together.

```{r}
V(net1)$label <- ifelse(E(net1)$Partner_Profession=="Yes","Yes",ifelse(E(net1)$Partner_Profession=="No","No",NA))
par(mar=c(0,0,0,0)); plot(net1)
```

##SNA Statistics
```{r}
#Betweeness - calculated for each node by looking at the number of shortest paths between every pair of nodes in the network and counting how many of those paths goes through the subject node. 
plot(betweenness(net1))
	 
#Degree - number of edges
plot(degree(net1))

#Closeness - number of steps to reach every other vertex from a given vertex
closeness(net1, mode="in") 

#Eigenvector centrality- measures importance of a node based on the ¡§importance¡¨ of the nodes it is connected to; unlike degree because it is a qualified metric
eigen_centrality(net1)

```
